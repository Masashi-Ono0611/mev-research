# TON内MEVデータ取得・初期分析方針（24hスナップショット）

## 目的
- STON.fiのUSDT<>TONペアを対象に、直近24時間でサンドイッチ等の有害MEVの有無と規模を掴む。
- スリッページ分布や遅延を簡易に測り、問題の有無を可視化する。

## 取得対象（最小セット）
1. **スワップログ（USDT<>TON on STON.fi）**
   - tx hash, block高さ, timestamp, sender, amount_in/out, 取得できればプール状態（before/after）。
   - 用途: サンドイッチ検知、スリッページ分布、トレードサイズ分布。
2. **ブロックメタデータ**
   - block高さ, timestamp, proposer/validator/builder（判明分）, tx数。
   - 用途: 送信→含まれる遅延、集中度の粗い把握。
3. **送信時刻（可能なら）**
   - 用途: 送信→含まれるまでの秒数分布、並び替え兆候。
4. **リファレンス価格**
   - TON/USDTの外部価格（CEXや他DEX）。
   - 用途: 公正価格推定、サンドイッチ時の価格乖離確認。

## 指標・検知
- サンドイッチ疑い: スワップ前後に逆→同方向の近接txがあり、被害者の実効価格が悪化。
- スリッページ分布: 期待レートとの差分を集計。
- 遅延: 送信時刻が取れれば送信→含まれる秒数の分布。
- 集中度（簡易）: 24hの提案者/ビルダー分布。

## 範囲
- 期間: 直近24時間に限定。
- ペア: STON.fi USDT<>TON のみ（初回スコープ縮小）。

## 理由（この粒度で始めるワケ）
- 初回から広げるとデータ量・実装コストが膨らむため、1ペア・24hで有害MEVの兆候をまず確認する。
- 問題が見えたら他ペアや期間、ブリッジ経路に拡張する。

## 次のステップ案
- スワップログ取得スクリプト雛形を作成し、24hデータをpull。
- サンドイッチ簡易検知とスリッページ分布を算出。
- ブロックメタと突合し、遅延・集中度をざっくり算出し可視化。
